<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="CUDA’s parallel model: Threads,Blocks and Grids." href="02cudaparallel.html" /><link rel="prev" title="Welcome to CUDA on ADA’s documentation!" href="index.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>Getting started - CUDA on ADA 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=058af07a" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">CUDA on ADA 1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">CUDA on ADA 1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="02cudaparallel.html">CUDA’s parallel model: Threads,Blocks and Grids.</a></li>
<li class="toctree-l1"><a class="reference internal" href="03mem_mgmt.html">Memory Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="04errorhandling.html">Error handling in CUDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="usinglibs.html">Using CUDA libraries</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Link to this heading">#</a></h1>
<section id="loading-modules-and-device-properties">
<h2>Loading modules and device properties<a class="headerlink" href="#loading-modules-and-device-properties" title="Link to this heading">#</a></h2>
<p>This section will discuss about loading specific modules to run CUDA jobs.
The first one you need is</p>
<p><code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">cuda-&lt;version_number&gt;</span></code></p>
<p>Curerntly ADA has CUDA/12.2.2. However other versions could be requested if need be.
One would also need GCC flags, this can be done with</p>
<p><code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">gcc-uoneasy/&lt;version_number&gt;</span></code></p>
<p>There can be two ways of using a GPU node, depending on the user’s requriement. One is the batch mode, and one is the interactive session.
The first one will require SLURM based commands as discussed below to be able to submit a job. In either case, the command</p>
<p><code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code> can be used to see if the hardware requested has NVIDIA-cards or not. The output will look something as follows,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>+---------------------------------------------------------------------------------------+
<span class="p">|</span><span class="w"> </span>NVIDIA-SMI<span class="w"> </span><span class="m">545</span>.23.08<span class="w">              </span>Driver<span class="w"> </span>Version:<span class="w"> </span><span class="m">545</span>.23.08<span class="w">    </span>CUDA<span class="w"> </span>Version:<span class="w"> </span><span class="m">12</span>.3<span class="w">     </span><span class="p">|</span>
<span class="p">|</span>-----------------------------------------+----------------------+----------------------+
<span class="p">|</span><span class="w"> </span>GPU<span class="w">  </span>Name<span class="w">                 </span>Persistence-M<span class="w"> </span><span class="p">|</span><span class="w"> </span>Bus-Id<span class="w">        </span>Disp.A<span class="w"> </span><span class="p">|</span><span class="w"> </span>Volatile<span class="w"> </span>Uncorr.<span class="w"> </span>ECC<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Fan<span class="w">  </span>Temp<span class="w">   </span>Perf<span class="w">          </span>Pwr:Usage/Cap<span class="w"> </span><span class="p">|</span><span class="w">         </span>Memory-Usage<span class="w"> </span><span class="p">|</span><span class="w"> </span>GPU-Util<span class="w">  </span>Compute<span class="w"> </span>M.<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">               </span>MIG<span class="w"> </span>M.<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="o">=========================================</span>+<span class="o">======================</span>+<span class="o">======================</span><span class="p">|</span>
<span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span>NVIDIA<span class="w"> </span>A100<span class="w"> </span>80GB<span class="w"> </span>PCIe<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:01:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                   </span>On<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>23C<span class="w">    </span>P0<span class="w">              </span>40W<span class="w"> </span>/<span class="w"> </span>300W<span class="w"> </span><span class="p">|</span><span class="w">     </span>87MiB<span class="w"> </span>/<span class="w"> </span>81920MiB<span class="w"> </span><span class="p">|</span><span class="w">     </span>N/A<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">              </span>Enabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+----------------------+----------------------+
<span class="p">|</span><span class="w">   </span><span class="m">1</span><span class="w">  </span>NVIDIA<span class="w"> </span>A100<span class="w"> </span>80GB<span class="w"> </span>PCIe<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:02:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                   </span>On<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>23C<span class="w">    </span>P0<span class="w">              </span>40W<span class="w"> </span>/<span class="w"> </span>300W<span class="w"> </span><span class="p">|</span><span class="w">     </span>87MiB<span class="w"> </span>/<span class="w"> </span>81920MiB<span class="w"> </span><span class="p">|</span><span class="w">     </span>N/A<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">              </span>Enabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+----------------------+----------------------+
<span class="p">|</span><span class="w">   </span><span class="m">2</span><span class="w">  </span>NVIDIA<span class="w"> </span>A100<span class="w"> </span>80GB<span class="w"> </span>PCIe<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:61:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                   </span>On<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>21C<span class="w">    </span>P0<span class="w">              </span>38W<span class="w"> </span>/<span class="w"> </span>300W<span class="w"> </span><span class="p">|</span><span class="w">     </span>87MiB<span class="w"> </span>/<span class="w"> </span>81920MiB<span class="w"> </span><span class="p">|</span><span class="w">     </span>N/A<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">              </span>Enabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+----------------------+----------------------+
<span class="p">|</span><span class="w">   </span><span class="m">3</span><span class="w">  </span>NVIDIA<span class="w"> </span>A100<span class="w"> </span>80GB<span class="w"> </span>PCIe<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:62:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                   </span>On<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>22C<span class="w">    </span>P0<span class="w">              </span>39W<span class="w"> </span>/<span class="w"> </span>300W<span class="w"> </span><span class="p">|</span><span class="w">     </span>87MiB<span class="w"> </span>/<span class="w"> </span>81920MiB<span class="w"> </span><span class="p">|</span><span class="w">     </span>N/A<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">              </span>Enabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+----------------------+----------------------+
<span class="p">|</span><span class="w">   </span><span class="m">4</span><span class="w">  </span>NVIDIA<span class="w"> </span>A100<span class="w"> </span>80GB<span class="w"> </span>PCIe<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:81:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                   </span>On<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>23C<span class="w">    </span>P0<span class="w">              </span>41W<span class="w"> </span>/<span class="w"> </span>300W<span class="w"> </span><span class="p">|</span><span class="w">     </span>87MiB<span class="w"> </span>/<span class="w"> </span>81920MiB<span class="w"> </span><span class="p">|</span><span class="w">     </span>N/A<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">              </span>Enabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+----------------------+----------------------+
<span class="p">|</span><span class="w">   </span><span class="m">5</span><span class="w">  </span>NVIDIA<span class="w"> </span>A100<span class="w"> </span>80GB<span class="w"> </span>PCIe<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:82:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                   </span>On<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>22C<span class="w">    </span>P0<span class="w">              </span>39W<span class="w"> </span>/<span class="w"> </span>300W<span class="w"> </span><span class="p">|</span><span class="w">     </span>87MiB<span class="w"> </span>/<span class="w"> </span>81920MiB<span class="w"> </span><span class="p">|</span><span class="w">     </span>N/A<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">              </span>Enabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+----------------------+----------------------+
<span class="p">|</span><span class="w">   </span><span class="m">6</span><span class="w">  </span>NVIDIA<span class="w"> </span>A100<span class="w"> </span>80GB<span class="w"> </span>PCIe<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:E1:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                   </span>On<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>23C<span class="w">    </span>P0<span class="w">              </span>39W<span class="w"> </span>/<span class="w"> </span>300W<span class="w"> </span><span class="p">|</span><span class="w">     </span>87MiB<span class="w"> </span>/<span class="w"> </span>81920MiB<span class="w"> </span><span class="p">|</span><span class="w">     </span>N/A<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">              </span>Enabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+----------------------+----------------------+
<span class="p">|</span><span class="w">   </span><span class="m">7</span><span class="w">  </span>NVIDIA<span class="w"> </span>A100<span class="w"> </span>80GB<span class="w"> </span>PCIe<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:E2:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                   </span>On<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>22C<span class="w">    </span>P0<span class="w">              </span>39W<span class="w"> </span>/<span class="w"> </span>300W<span class="w"> </span><span class="p">|</span><span class="w">     </span>87MiB<span class="w"> </span>/<span class="w"> </span>81920MiB<span class="w"> </span><span class="p">|</span><span class="w">     </span>N/A<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">              </span>Enabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+----------------------+----------------------+

+---------------------------------------------------------------------------------------+
<span class="p">|</span><span class="w"> </span>MIG<span class="w"> </span>devices:<span class="w">                                                                          </span><span class="p">|</span>
+------------------+--------------------------------+-----------+-----------------------+
<span class="p">|</span><span class="w"> </span>GPU<span class="w">  </span>GI<span class="w">  </span>CI<span class="w">  </span>MIG<span class="w"> </span><span class="p">|</span><span class="w">                   </span>Memory-Usage<span class="w"> </span><span class="p">|</span><span class="w">        </span>Vol<span class="p">|</span><span class="w">      </span>Shared<span class="w">           </span><span class="p">|</span>
<span class="p">|</span><span class="w">      </span>ID<span class="w">  </span>ID<span class="w">  </span>Dev<span class="w"> </span><span class="p">|</span><span class="w">                     </span>BAR1-Usage<span class="w"> </span><span class="p">|</span><span class="w"> </span>SM<span class="w">     </span>Unc<span class="p">|</span><span class="w"> </span>CE<span class="w"> </span>ENC<span class="w"> </span>DEC<span class="w"> </span>OFA<span class="w"> </span>JPG<span class="w">    </span><span class="p">|</span>
<span class="p">|</span><span class="w">                  </span><span class="p">|</span><span class="w">                                </span><span class="p">|</span><span class="w">        </span>ECC<span class="p">|</span><span class="w">                       </span><span class="p">|</span>
<span class="p">|</span><span class="o">==================</span>+<span class="o">================================</span>+<span class="o">===========</span>+<span class="o">=======================</span><span class="p">|</span>
<span class="p">|</span><span class="w">  </span><span class="m">0</span><span class="w">    </span><span class="m">7</span><span class="w">   </span><span class="m">0</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">              </span>12MiB<span class="w"> </span>/<span class="w">  </span>9728MiB<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">14</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span><span class="w">    </span><span class="m">0</span><span class="w">    </span><span class="m">0</span><span class="w">    </span><span class="m">0</span><span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                  </span><span class="p">|</span><span class="w">               </span>0MiB<span class="w"> </span>/<span class="w"> </span>16383MiB<span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="p">|</span><span class="w">                       </span><span class="p">|</span>
+------------------+--------------------------------+-----------+-----------------------+

+---------------------------------------------------------------------------------------+
<span class="p">|</span><span class="w"> </span>Processes:<span class="w">                                                                            </span><span class="p">|</span>
<span class="p">|</span><span class="w">  </span>GPU<span class="w">   </span>GI<span class="w">   </span>CI<span class="w">        </span>PID<span class="w">   </span>Type<span class="w">   </span>Process<span class="w"> </span>name<span class="w">                            </span>GPU<span class="w"> </span>Memory<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span>ID<span class="w">   </span>ID<span class="w">                                                             </span>Usage<span class="w">      </span><span class="p">|</span>
<span class="p">|</span><span class="o">=======================================================================================</span><span class="p">|</span>
<span class="p">|</span><span class="w">  </span>No<span class="w"> </span>running<span class="w"> </span>processes<span class="w"> </span>found<span class="w">                                                           </span><span class="p">|</span>
+---------------------------------------------------------------------------------------+
</pre></div>
</div>
<p>This is an output from the Ampere-q partition, indicating there are 8 GPU cards, indexed from 0 to 7. Similarly the compiler used to compile CUDA programs, known as nvcc or (Nvidia Cuda Compiler) can also be checked with the command,</p>
<p><code class="docutils literal notranslate"><span class="pre">nvcc</span> <span class="pre">--help</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Usage<span class="w">  </span>:<span class="w"> </span>nvcc<span class="w"> </span><span class="o">[</span>options<span class="o">]</span><span class="w"> </span>&lt;inputfile&gt;

Options<span class="w"> </span><span class="k">for</span><span class="w"> </span>specifying<span class="w"> </span>the<span class="w"> </span>compilation<span class="w"> </span><span class="nv">phase</span>
<span class="o">============================================</span>
More<span class="w"> </span>exactly,<span class="w"> </span>this<span class="w"> </span>option<span class="w"> </span>specifies<span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>which<span class="w"> </span>stage<span class="w"> </span>the<span class="w"> </span>input<span class="w"> </span>files<span class="w"> </span>must<span class="w"> </span>be<span class="w"> </span>compiled,
according<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>compilation<span class="w"> </span>trajectories<span class="w"> </span><span class="k">for</span><span class="w"> </span>different<span class="w"> </span>input<span class="w"> </span>file<span class="w"> </span>types:
<span class="w">        </span>.c/.cc/.cpp/.cxx<span class="w"> </span>:<span class="w"> </span>preprocess,<span class="w"> </span>compile,<span class="w"> </span>link
<span class="w">        </span>.o<span class="w">               </span>:<span class="w"> </span>link
<span class="w">        </span>.i/.ii<span class="w">           </span>:<span class="w"> </span>compile,<span class="w"> </span>link
<span class="w">        </span>.cu<span class="w">              </span>:<span class="w"> </span>preprocess,<span class="w"> </span>cuda<span class="w"> </span>frontend,<span class="w"> </span>PTX<span class="w"> </span>assemble,
<span class="w">                        </span>merge<span class="w"> </span>with<span class="w"> </span>host<span class="w"> </span>C<span class="w"> </span>code,<span class="w"> </span>compile,<span class="w"> </span>link
<span class="w">        </span>.gpu<span class="w">             </span>:<span class="w"> </span>cicc<span class="w"> </span>compile<span class="w"> </span>into<span class="w"> </span>cubin
<span class="w">        </span>.ptx<span class="w">             </span>:<span class="w"> </span>PTX<span class="w"> </span>assemble<span class="w"> </span>into<span class="w"> </span>cubin.
.
.
.
</pre></div>
</div>
</section>
<section id="submit-a-basic-cuda-program-in-batch">
<h2>Submit a basic CUDA program in batch.<a class="headerlink" href="#submit-a-basic-cuda-program-in-batch" title="Link to this heading">#</a></h2>
<p>Copy the following folder to your directory. This will have a file <code class="docutils literal notranslate"><span class="pre">01-hello-gpu.cu</span></code> and a SLURM file <code class="docutils literal notranslate"><span class="pre">submit.slurm</span></code> which will submit the job on the Ampere-q partition. If not, save the following code, as <code class="docutils literal notranslate"><span class="pre">01-hello-gpu.cu</span></code> in youur directory.
The files should also contain the solutions by the filename <code class="docutils literal notranslate"><span class="pre">01-hello-gpu-solution.cu</span></code></p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Very first CUDA exercise</span><a class="headerlink" href="#id1" title="Link to this code">#</a></div>
<div class="highlight-CUDA notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">helloCPU</span><span class="p">()</span>
<span class="p">{</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello from the CPU.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* Refactor the `helloGPU` definition to be a kernel</span>
<span class="cm">* that can be launched on the GPU. Update its message</span>
<span class="cm">* to read &quot;Hello from the GPU!&quot;</span>
<span class="cm">*/</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">helloGPU</span><span class="p">()</span>
<span class="p">{</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello also from the GPU.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>

<span class="cm">/*</span>
<span class="cm">* Refactor this call to `helloGPU` so that it launches</span>
<span class="cm">* as a kernel on the GPU.</span>
<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm">* Add code below to synchronize on the completion of the</span>
<span class="cm">* `helloGPU` kernel completion before continuing the CPU</span>
<span class="cm">* thread.</span>
<span class="cm">*/</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>In this progarm two functions are provided, one is to be run from CPU and the other from GPU. Take your time to see if you can write a main function to solve the problem above.</p>
</section>
<section id="compiling-a-cuda-program">
<h2>Compiling a CUDA program<a class="headerlink" href="#compiling-a-cuda-program" title="Link to this heading">#</a></h2>
<p>Once, you have a result, the code is compiled as follows, if you are on an interactive session.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nvcc<span class="w"> </span><span class="m">01</span>-hello-gpu.cu<span class="w"> </span>-o<span class="w"> </span>01hello.out<span class="w"> </span>-gencode<span class="w"> </span><span class="nv">arch</span><span class="o">=</span>compute_80,code<span class="o">=</span>sm_80
</pre></div>
</div>
<p>This should create an executable file by the name of 01hello.out (you can name this anything else, as the output flag is <code class="docutils literal notranslate"><span class="pre">-o</span></code>)</p>
<p>In an interactive session, this is run by,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./01hello.out
</pre></div>
</div>
<p>And while submitting via a batch submission, the SLURM script can look like the following,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --job-name=hellogpu</span>
<span class="c1">#SBATCH --time=00:05:00</span>
<span class="c1">#SBATCH --partition=ampereq</span>
<span class="c1">#SBATCH --gres=gpu:8          ### you can change this number accordingly but cannot exceed 8 (on ampereq)</span>

module<span class="w"> </span>load<span class="w"> </span>cuda-12.2.2
module<span class="w"> </span>load<span class="w"> </span>gcc-uoneasy/8.3.0

nvcc<span class="w"> </span><span class="m">01</span>-hello-gpu-solution.cu<span class="w"> </span>-o<span class="w"> </span>01hello.out<span class="w"> </span>-gencode<span class="w"> </span><span class="nv">arch</span><span class="o">=</span>compute_80,code<span class="o">=</span>sm_80

./01hello.out
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> is often helpful here, as sometimes there are external libraries or flags that need to be passed to the CUDA program. An example will be discussed later in <a class="reference internal" href="usinglibs.html#external-libraries-compiled-using-makefiles"><span class="std std-ref">External libraries compiled using Makefiles</span></a>.</p>
<p>The solution is provided below and in <code class="docutils literal notranslate"><span class="pre">01-hello-gpu-solution.cu</span></code>, as follows:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">helloCPU</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello from the CPU.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/*</span>
<span class="cm">* The addition of `__global__` signifies that this function</span>
<span class="cm">* should be launced on the GPU.</span>
<span class="cm">*/</span>
<span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">helloGPU</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello from the GPU.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">helloCPU</span><span class="p">();</span>
<span class="cm">/*</span>
<span class="cm">* Add an execution configuration with the &lt;&lt;&lt;...&gt;&gt;&gt; syntax</span>
<span class="cm">* will launch this function as a kernel on the GPU.</span>
<span class="cm">* The numbers inside the &lt;&lt;&lt;gridDim, blockDim&gt;&gt;&gt; will be discussed further.</span>
<span class="cm">*/</span>

<span class="w">    </span><span class="n">helloGPU</span><span class="o">&lt;&lt;&lt;</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="o">&gt;&gt;&gt;</span><span class="p">();</span><span class="w"> </span><span class="c1">//change these numbers and have fun.</span>

<span class="cm">/*</span>
<span class="cm">* `cudaDeviceSynchronize` will block the CPU stream until</span>
<span class="cm">* all GPU kernels have completed.</span>
<span class="cm">*/</span>

<span class="w">    </span><span class="n">cudaDeviceSynchronize</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The output should then look something like the following, depending on the number provided in the kernels. or <code class="docutils literal notranslate"><span class="pre">&lt;&lt;&lt;1,16&gt;&gt;&gt;</span></code> in the case below.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Hello</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">CPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="n">Hello</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
</pre></div>
</div>
<p>Congratulations on having run the first CUDA code.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="02cudaparallel.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">CUDA’s parallel model: Threads,Blocks and Grids.</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Atul Singh
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Getting started</a><ul>
<li><a class="reference internal" href="#loading-modules-and-device-properties">Loading modules and device properties</a></li>
<li><a class="reference internal" href="#submit-a-basic-cuda-program-in-batch">Submit a basic CUDA program in batch.</a></li>
<li><a class="reference internal" href="#compiling-a-cuda-program">Compiling a CUDA program</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>